@using Auction_Prop_Buyers.Models.DisplayMadels
@model RegisteredBuyer

@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/_Layout.cshtml";
}


<h2>Profile</h2>

<div>
    <h4>Your Information</h4>
    <hr />
    <dl class="dl-horizontal">
   
        <dt>
            @Html.DisplayNameFor(model => model.FirstName)
        </dt>

        <dd>
            @Html.DisplayFor(model => model.FirstName)
        </dd>

        <dt>
            @Html.DisplayNameFor(model => model.LastName)
        </dt>

        <dd>
            @Html.DisplayFor(model => model.LastName)
        </dd>

        <dt>
            @Html.DisplayNameFor(model => model.DateOfBirth)
        </dt>

        <dd>
            @Html.DisplayFor(model => model.DateOfBirth)
        </dd>

        <dt>
            @Html.DisplayNameFor(model => model.ApprovalStatus)
        </dt>

        <dd>
            @Html.DisplayFor(model => model.ApprovalStatus)
        </dd>

        <dt>
            @Html.DisplayNameFor(model => model.RegistrationDate)
        </dt>

        <dd>
            @Html.DisplayFor(model => model.RegistrationDate)
        </dd>

        <dt>
            @Html.DisplayNameFor(model => model.Signiture)
        </dt>

        <dd>
            @Html.DisplayFor(model => model.Signiture)
        </dd>

    </dl><div style="max-width:20%">
    @if (Model.AuctionRegistrations == null)
    {
        <h1>
            Congratulations!
        </h1>
        <p>
            You are now Registered as a Buyer with Auction-Prop. You're Registration will be reviewed for approval
            You can view all our listings on the Properties page whilest you await approval
            @Html.ActionLink("View Property lListings.", "Properties", "Home");
        </p>


    }
    else
    {

        <h1>You Are Registered For The Following Aucitons</h1>
        <div class="row">
            @foreach (AuctionRegistration Auc in Model.AuctionRegistrations)
            {
                bool bankG = false;
                bool bankApp = false;
            <div class="col-md-4">
                <h2>@Auc.Property.Title</h2>
                <h3>@Auc.Property.Address</h3>

                @if (Auc.Bonded)
                {
                    try
                    {
                        if (Auc.BankApproval == null)
                        {
                            throw new Exception();
                        }
                        else
                        {
                            bankApp = true;
                        }

                    }
                    catch
                    {
                        @Html.ActionLink("Click Here to submit youre Bank Pre Approval", "AdPreApproval", "Buyers", new { id = Auc.PropertyID }, null)
            <p>For Any Assistance Please Contact One Of Our Bond Originators:  admin@infinitymortgagefinance.co.za</p>
                    }
                }
                else
                {
                    try
                    {
                        if (Auc.Guarintee == null )
                        {
                            throw new NullReferenceException();


                        }
                         else
                        {
                            bankG = true;
                        }
                     
                    }
                    catch(NullReferenceException e)
                    {

                        @Html.ActionLink("Click Here to go to Auction", "AddBankGuarintee", "Buyers", new { id = Auc.PropertyID }, null)
                    }
                }
                @if (bankApp || bankG)
                {
                    try
                    {
                        <h3>Congratulations</h3>
                        <p>You Are Now Registered To Bid On This Auction</p>
                        if (Auc.Property.Auction.StartTime >= DateTime.Now)
                        {
                            <p>This Auction Starts At @Auc.Property.Auction.StartTime</p>
                        }
                        else if (Auc.Property.Auction.StartTime <= DateTime.Now && DateTime.Now <= Auc.Property.Auction.EndTime)
                        {
                            @Html.ActionLink("Click Here to go to Auction", "Index", "AuctionRoom", new { id = Auc.Property.Auction.PropertyID }, null)
                        }



                    }
                    catch
                    {

                        <h3>Congratulations</h3>
                        <p>You Are Now Registered to Bid On This Auction</p>

                        <p>This Propperty Is Not Yet Scheduled For Auction</p>
                    }
                }


                <img alt="" src=@Auc.Property.PropertyPhotos.First().PropertyPhotoPath>
            </div>
            }
        </div>
     

    }
</div>
</div>



<p>
    @Html.ActionLink("Click here to go back to Property listings", "Properties", "home")
</p>
